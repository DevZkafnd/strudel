<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Strudel Music Project</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            color: white;
            min-height: 100vh;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        h1 { text-align: center; color: #fff; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); margin-bottom: 30px; }
        .example-section { background: rgba(255,255,255,0.1); border-radius: 10px; padding: 20px; margin: 20px 0; backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2); }
        .code-block { background: #2d3748; border-radius: 8px; padding: 15px; margin: 15px 0; overflow-x: auto; border-left: 4px solid #667eea; }
        .play-button { background: #48bb78; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 16px; margin: 10px 5px; transition: all 0.3s ease; }
        .play-button:hover { background: #38a169; transform: translateY(-2px); }
        .stop-button { background: #f56565; }
        .stop-button:hover { background: #e53e3e; }
        .controls { display: flex; gap: 10px; flex-wrap: wrap; margin: 15px 0; }
        .info { background: rgba(59, 130, 246, 0.2); border-left: 4px solid #3b82f6; padding: 15px; margin: 15px 0; border-radius: 0 8px 8px 0; }
        .warning { background: rgba(245, 158, 11, 0.2); border-left: 4px solid #f59e0b; padding: 15px; margin: 15px 0; border-radius: 0 8px 8px 0; }
    </style>
    <!-- Strudel browser bundle via CDN -->
    <script defer src="https://cdn.jsdelivr.net/npm/@strudel/web@latest/dist/web.js"></script>
    <script type="module" defer src="./examples.js"></script>
</head>
<body>
    <div class="container">
        <h1>üéµ Strudel Music Project üéµ</h1>
        <div class="info"><strong>Info:</strong> Klik tombol Play, browser akan meminta izin audio jika perlu.</div>

        <div class="example-section">
            <h2>üéß Contoh 6: DJ Loop (House 124 BPM)</h2>
            <div class="code-block"><code>djLoops.house124</code></div>
            <div class="controls">
                <button id="ex6-play" class="play-button">‚ñ∂Ô∏è Play</button>
                <button data-stop class="stop-button">‚èπÔ∏è Stop</button>
            </div>
        </div>

        <div class="example-section">
            <h2>üéöÔ∏è Contoh 7: DJ Loop (Techno 128 BPM)</h2>
            <div class="code-block"><code>djLoops.techno128</code></div>
            <div class="controls">
                <button id="ex7-play" class="play-button">‚ñ∂Ô∏è Play</button>
                <button data-stop class="stop-button">‚èπÔ∏è Stop</button>
            </div>
        </div>

        <div class="example-section">
            <h2>üåô Contoh 8: Chill Loop (90 BPM)</h2>
            <div class="code-block"><code>chillLoops.chill90</code></div>
            <div class="controls">
                <button id="ex8-play" class="play-button">‚ñ∂Ô∏è Play</button>
                <button data-stop class="stop-button">‚èπÔ∏è Stop</button>
            </div>
        </div>

        <div class="example-section">
            <h2>üè¥‚Äç‚ò†Ô∏è Contoh 9: Guitar Theme (Pirates-style)</h2>
            <div class="code-block"><code>guitarThemes.piratesMinor</code></div>
            <div class="controls">
                <button id="ex9-play" class="play-button">‚ñ∂Ô∏è Play</button>
                <button data-stop class="stop-button">‚èπÔ∏è Stop</button>
            </div>
        </div>
            <h2>üéπ Contoh 1: Melodi Sederhana</h2>
            <div class="code-block"><code>note("c d e f g", "1 0.5 0.5 1 2")</code></div>
            <div class="controls">
                <button id="ex1-play" class="play-button">‚ñ∂Ô∏è Play</button>
                <button data-stop class="stop-button">‚èπÔ∏è Stop</button>
            </div>
        </div>

        <div class="example-section">
            <h2>ü•Å Contoh 2: Drum Pattern</h2>
            <div class="code-block"><code>stack(s("bd*4"), s("~ sn ~ sn"), s("hh*8"))</code></div>
            <div class="controls">
                <button id="ex2-play" class="play-button">‚ñ∂Ô∏è Play</button>
                <button data-stop class="stop-button">‚èπÔ∏è Stop</button>
            </div>
        </div>

        <div class="example-section">
            <h2>üé∏ Contoh 3: Chord Progression</h2>
            <div class="code-block"><code>chord("c f g c", "2")</code></div>
            <div class="controls">
                <button id="ex3-play" class="play-button">‚ñ∂Ô∏è Play</button>
                <button data-stop class="stop-button">‚èπÔ∏è Stop</button>
            </div>
        </div>

        <div class="example-section">
            <h2>üéº Contoh 4: Melodi dengan Efek</h2>
            <div class="code-block"><code>note("c4 d4 e4 f4 g4 a4 b4 c5", "0.5").gain(0.3).reverb(0.8).delay(0.5, 0.3)</code></div>
            <div class="controls">
                <button id="ex4-play" class="play-button">‚ñ∂Ô∏è Play</button>
                <button data-stop class="stop-button">‚èπÔ∏è Stop</button>
            </div>
        </div>

        <div class="example-section">
            <h2>üéµ Contoh 5: Pattern Kompleks</h2>
            <div class="code-block"><code>stack(note("c4 e4 g4", "2").gain(0.4), note("c2", "1").gain(0.6), s("bd*2 ~ sn ~ bd*2"))</code></div>
            <div class="controls">
                <button id="ex5-play" class="play-button">‚ñ∂Ô∏è Play</button>
                <button data-stop class="stop-button">‚èπÔ∏è Stop</button>
            </div>
        </div>

        <div class="example-section">
            <h2>üîß Live Coding Area</h2>
            <textarea id="liveCode" rows="6" style="width: 100%; background: #2d3748; color: white; border: none; border-radius: 8px; padding: 15px; font-family: 'Courier New', monospace;" placeholder="contoh: note('c d e f g', '1 0.5 0.5 1 2')"></textarea>
            <div class="controls">
                <button id="live-play" class="play-button">‚ñ∂Ô∏è Play Live Code</button>
                <button data-stop class="stop-button">‚èπÔ∏è Stop</button>
            </div>
        </div>

        <div class="warning"><strong>‚ö†Ô∏è Penting:</strong> Jika tidak ada suara, klik sekali di halaman untuk mengaktifkan audio, lalu tekan Play lagi.</div>
        <div class="info"><strong>üìö Dokumentasi:</strong> <a href="https://strudel.cc/learn/getting-started/" target="_blank" style="color: #90cdf4;">Strudel Docs</a></div>
    </div>

    <script>
        // Tunggu bundle Strudel siap
        function ensureStrudelReady() {
            return new Promise((resolve) => {
                if (window.strudel && window.evalCode) return resolve();
                const i = setInterval(() => {
                    if (window.strudel && window.evalCode) { clearInterval(i); resolve(); }
                }, 50);
            });
        }
        async function run(code) {
            await ensureStrudelReady();
            try { await window.evalCode(code); } catch (e) { console.error(e); alert(e.message || e); }
        }
        // Mapping contoh agar tidak menaruh kode di atribut HTML
        const examples = {
            ex1: 'note("c d e f g", "1 0.5 0.5 1 2")',
            ex2: 'stack( s("bd*4"), s("~ sn ~ sn"), s("hh*8") )',
            ex3: 'chord("c f g c", "2")',
            ex4: 'note("c4 d4 e4 f4 g4 a4 b4 c5", "0.5").gain(0.3).reverb(0.8).delay(0.5, 0.3)',
            ex5: 'stack( note("c4 e4 g4", "2").gain(0.4), note("c2", "1").gain(0.6), s("bd*2 ~ sn ~ bd*2") )'
        };
        // Pasang event listeners setelah DOM siap
        window.addEventListener('DOMContentLoaded', () => {
            document.getElementById('ex1-play').addEventListener('click', () => run(examples.ex1));
            document.getElementById('ex2-play').addEventListener('click', () => run(examples.ex2));
            document.getElementById('ex3-play').addEventListener('click', () => run(examples.ex3));
            document.getElementById('ex4-play').addEventListener('click', () => run(examples.ex4));
            document.getElementById('ex5-play').addEventListener('click', () => run(examples.ex5));
            document.getElementById('ex6-play').addEventListener('click', () => run(window.djLoops?.house124 || ''));
            document.getElementById('ex7-play').addEventListener('click', () => run(window.djLoops?.techno128 || ''));
            document.getElementById('ex8-play').addEventListener('click', () => run(window.chillLoops?.chill90 || ''));
            document.getElementById('ex9-play').addEventListener('click', () => run(window.guitarThemes?.piratesMinor || ''));
            document.getElementById('live-play').addEventListener('click', async () => {
                const code = document.getElementById('liveCode').value;
                if (code.trim()) { await run(code); }
            });
            document.querySelectorAll('button[data-stop]').forEach(btn => btn.addEventListener('click', () => run('hush()')));
        });
        // auto-unlock audio on first user gesture
        window.addEventListener('click', () => {}, { once: true });
    </script>
</body>
</html>
